<html>

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-46332195-9"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-46332195-9');
    </script>

    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); const f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-MGS4TSP');</script>
    <!-- End Google Tag Manager -->

    <meta charset='utf-8' />
    <title>Límits Catalunya</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.3.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.3.1/mapbox-gl.css' rel='stylesheet' />
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" />
    <script
        src='https://github.com/lukasmartinelli/mapbox-gl-inspect/releases/download/v1.3.1/mapbox-gl-inspect.js'></script>
    <link href='https://github.com/lukasmartinelli/mapbox-gl-inspect/releases/download/v1.3.1/mapbox-gl-inspect.css'
        rel='stylesheet' />
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
            height: 100%
        }

        #menu {
            position: absolute;
            z-index: 1000;
            background: #fff;
            padding: 10px;
            font-family: 'Open Sans', sans-serif;
            top: 5px;
            left: 5px;
            border-radius: 7px;
            -webkit-box-shadow: 5px 5px 5px -5px rgba(0, 0, 0, 0.75);
            -moz-box-shadow: 5px 5px 5px -5px rgba(0, 0, 0, 0.75);
            box-shadow: 5px 5px 5px -5px rgba(0, 0, 0, 0.75);
        }

        #div_pitch {
            position: absolute;
            right: 10px;
            top: 142px;
            width: 30px;
            z-index: 100;
        }

        .slider {
            /* border: 1px solid red; */
            padding-bottom: 8px;
            /* border-bottom: 1px solid gray; */
            padding-top: 2px;
        }

        .sliderClass {
            position: absolute;
            left: 10px;
            top: 79px;
            width: 250px;
            z-index: 100;
            display: block;
            background-color: white;
            padding: 10px;
            border-radius: 4px;
            font-size: 0.85em;
            opacity: 0.9;
            overflow: hidden;

        }
    </style>

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MGS4TSP" height="0" width="0"
            style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div id='div_pitch' class="mapboxgl-ctrl-group mapboxgl-ctrl">
        <button id="bt_pitch" title="Perspectiva" class="mapboxgl-ctrl-icon glyphicon glyphicon-road"></button>
    </div>

    <div class="sliderClass">
        <div class="slider">
            <label>Municipis 2019:
                <span id='slider-value'>0%</span>
            </label>
            <input id='slider' type='range' min='0' max='100' step='1' value='50' />
        </div>
        <div class="slider">
            <label>Comarques 2019:
                <span id='slider-value0'>0%</span>
            </label>
            <input id='slider0' type='range' min='0' max='100' step='1' value='0' />
        </div>

        <div class="slider">
            <label>Seccions censals 2016:
                <span id='slider-value7'>0%</span>
            </label>
            <input id='slider7' type='range' min='0' max='100' step='1' value='0' />
        </div>


        <div class="slider">
            <label>Regions policials 2019:
                <span id='slider-value8'>0%</span>
            </label>
            <input id='slider8' type='range' min='0' max='100' step='1' value='0' />
        </div>


        <div class="slider">
            <label>Àrees bàsiques policials 2019:
                <span id='slider-value9'>0%</span>
            </label>
            <input id='slider9' type='range' min='0' max='100' step='1' value='0' />
        </div>



        <div class="slider">
            <label>Regions snitàries 2018:
                <span id='slider-value1'>0%</span>
            </label>
            <input id='slider1' type='range' min='0' max='100' step='1' value='0' />
        </div>

        <div class="slider">
            <label>Sectors sanitàris 2018:
                <span id='slider-value2'>0%</span>
            </label>
            <input id='slider2' type='range' min='0' max='100' step='1' value='0' />
        </div>

        <div class="slider">
            <label>Àrees bàsiques salut 2018:
                <span id='slider-value3'>0%</span>
            </label>
            <input id='slider3' type='range' min='0' max='100' step='1' value='0' />
        </div>
        <div class="slider">
            <label>Àmbits planificació:
                <span id='slider-value4'>0%</span>
            </label>
            <input id='slider4' type='range' min='0' max='100' step='1' value='0' />
        </div>

        <div class="slider">
            <label>Àrees bàsiques serveis socials:
                <span id='slider-value5'>0%</span>
            </label>
            <input id='slider5' type='range' min='0' max='100' step='1' value='0' />
        </div>

        <div class="slider">
            <label>Partits judicials:
                <span id='slider-value6'>0%</span>
            </label>
            <input id='slider6' type='range' min='0' max='100' step='1' value='0' />
        </div>


    </div>

    <div id="map"></div>
    <script>
        const map;

        import {Map, NavigationControl,GeolocateControl} from 'https://cdn.skypack.dev/maplibre-gl';    
        map = new Map({
            container: 'map',
            style: 'https://tilemaps.icgc.cat/tileserver/styles/limits-catalunya.json',
            center: [2.16859, 41.3954],
            zoom: 8,
            maxZoom: 14.8,
            hash: true,
            pitch: 0
        });

        map.addControl(new MapboxInspect());
        map.addControl(new NavigationControl());

        map.on('load', function () {



            map.setPaintProperty("municipis_2019", "line-opacity", 0.5);
            map.setPaintProperty("comarques_2019", "line-opacity", 0);

            map.setPaintProperty("regions_sanitaries_2018", "line-opacity", 0);
            map.setPaintProperty("sectors_sanitaris_2018", "line-opacity", 0);
            map.setPaintProperty("arees_basiques_salut_2018", "line-opacity", 0);

            map.setPaintProperty("ambits_funcionals_planificacio", "line-opacity", 0);
            map.setPaintProperty("arees_basiques_serveis_socials", "line-opacity", 0);
            map.setPaintProperty("partits_judicials", "line-opacity", 0);
            map.setPaintProperty("seccions_censals_2016", "line-opacity", 0);
            map.setPaintProperty("regions_policials_2019", "line-opacity", 0);
            map.setPaintProperty("arees_basiques_policials_2019", "line-opacity", 0);

        });

        map.on('mousemove', function (e) {

            //console.info(e);

        });



        const button = document.getElementById('bt_pitch');
        const slider = document.getElementById('slider');
        const sliderValue = document.getElementById('slider-value');

        const slider0 = document.getElementById('slider0');
        const sliderValue0 = document.getElementById('slider-value0');

        const slider1 = document.getElementById('slider1');
        const sliderValue1 = document.getElementById('slider-value1');
        const slider2 = document.getElementById('slider2');
        const sliderValue2 = document.getElementById('slider-value2');
        const slider3 = document.getElementById('slider3');
        const sliderValue3 = document.getElementById('slider-value3');
        const slider4 = document.getElementById('slider4');
        const sliderValue4 = document.getElementById('slider-value4');
        const slider5 = document.getElementById('slider5');
        const sliderValue5 = document.getElementById('slider-value5');
        const slider6 = document.getElementById('slider6');
        const sliderValue6 = document.getElementById('slider-value6');
        const slider7 = document.getElementById('slider7');
        const sliderValue7 = document.getElementById('slider-value7');


        const slider8 = document.getElementById('slider8');
        const sliderValue8 = document.getElementById('slider-value8');

        const slider9 = document.getElementById('slider9');
        const sliderValue9 = document.getElementById('slider-value9');

        function canviaPerspectiva() {
            const pitch = parseInt(map.getPitch());
            pitch == 60 ? pitch = 0 : pitch = pitch + 30;
            map.easeTo({
                'pitch': pitch
            })
        };



        button.onclick = canviaPerspectiva;

        slider.addEventListener('input', function (e) {
            map.setPaintProperty('municipis_2019', 'line-opacity', parseInt(e.target.value, 10) / 100);
            sliderValue.textContent = e.target.value + '%';
        });

        slider0.addEventListener('input', function (e) {
            map.setPaintProperty('comarques_2019', 'line-opacity', parseInt(e.target.value, 10) / 100);
            sliderValue0.textContent = e.target.value + '%';
        });

        slider1.addEventListener('input', function (e) {
            map.setPaintProperty('regions_sanitaries_2018', 'line-opacity', parseInt(e.target.value, 10) / 100);
            sliderValue1.textContent = e.target.value + '%';
        });
        slider2.addEventListener('input', function (e) {
            map.setPaintProperty('sectors_sanitaris_2018', 'line-opacity', parseInt(e.target.value, 10) / 100);
            sliderValue2.textContent = e.target.value + '%';
        });
        slider3.addEventListener('input', function (e) {
            map.setPaintProperty('arees_basiques_salut_2018', 'line-opacity', parseInt(e.target.value, 10) / 100);
            sliderValue3.textContent = e.target.value + '%';
        });
        slider4.addEventListener('input', function (e) {
            map.setPaintProperty('ambits_funcionals_planificacio', 'line-opacity', parseInt(e.target.value, 10) / 100);
            sliderValue4.textContent = e.target.value + '%';
        });
        slider5.addEventListener('input', function (e) {
            map.setPaintProperty('arees_basiques_serveis_socials', 'line-opacity', parseInt(e.target.value, 10) / 100);
            sliderValue5.textContent = e.target.value + '%';
        });
        slider6.addEventListener('input', function (e) {
            map.setPaintProperty('partits_judicials', 'line-opacity', parseInt(e.target.value, 10) / 100);
            sliderValue6.textContent = e.target.value + '%';
        });
        slider7.addEventListener('input', function (e) {
            map.setPaintProperty('seccions_censals_2016', 'line-opacity', parseInt(e.target.value, 10) / 100);
            sliderValue7.textContent = e.target.value + '%';
        });

        slider8.addEventListener('input', function (e) {
            map.setPaintProperty('regions_policials_2019', 'line-opacity', parseInt(e.target.value, 10) / 100);
            sliderValue8.textContent = e.target.value + '%';
        });



        slider9.addEventListener('input', function (e) {
            map.setPaintProperty('arees_basiques_policials_2019', 'line-opacity', parseInt(e.target.value, 10) / 100);
            sliderValue9.textContent = e.target.value + '%';
        });
    </script>
</body>

</html>